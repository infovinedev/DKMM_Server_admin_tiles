<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.infovine.dkmm.mapper.nicknm.TDefineNicknmMapper">
  <resultMap id="BaseResultMap" type="kr.co.infovine.dkmm.db.model.nicknm.TDefineNicknm">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 25 11:29:08 KST 2022.
    -->
    <id column="nick_seq" jdbcType="INTEGER" property="nickSeq" />
    <result column="nick_nm" jdbcType="VARCHAR" property="nickNm" />
    <result column="nick_img" jdbcType="VARCHAR" property="nickImg" />
    <result column="work_seq" jdbcType="BIGINT" property="workSeq" />
    <result column="nick_comment" jdbcType="VARCHAR" property="nickComment" />
    <result column="del_yn" jdbcType="VARCHAR" property="delYn" />
    <result column="ins_seq" jdbcType="BIGINT" property="insSeq" />
    <result column="ins_dt" jdbcType="TIMESTAMP" property="insDt" />
    <result column="upt_seq" jdbcType="BIGINT" property="uptSeq" />
    <result column="upt_dt" jdbcType="TIMESTAMP" property="uptDt" />
    <result column="file_uuid" jdbcType="VARCHAR" property="fileUuid" />
    <result column="work_nm" jdbcType="VARCHAR" property="workNm" />
  </resultMap>
  <sql id="searchCondition_nick">
       <if test='searchStartDt neq null and !"".equals(searchStartDt)'>
        AND TO_CHAR(ins_dt, 'YYYY-MM-DD') BETWEEN #{searchStartDt} AND #{searchEndDt}
       </if>
       <if test='searchText neq null and !"".equals(searchText)'>
        AND nick_nm LIKE CONCAT('%', #{searchText}, '%')
       </if>
       <if test='searchType neq null and !"".equals(searchType)'>
       		<if test='searchType eq "Y" '>
	        AND file_uuid is not null
	       </if>
	       <if test='searchType eq "N" '>
	        AND file_uuid is null
	       </if>
       </if>
  </sql>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 25 11:29:08 KST 2022.
    -->
    delete from t_define_nicknm
    where nick_seq = #{nickSeq,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="kr.co.infovine.dkmm.db.model.nicknm.TDefineNicknm">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 25 11:29:08 KST 2022.
    -->
    insert into t_define_nicknm (nick_seq, nick_nm, nick_img, 
      work_seq, nick_comment, del_yn, 
      ins_seq, ins_dt, upt_seq, 
      upt_dt, file_uuid)
    values (#{nickSeq,jdbcType=INTEGER}, #{nickNm,jdbcType=VARCHAR}, #{nickImg,jdbcType=VARCHAR}, 
      #{workSeq,jdbcType=BIGINT}, #{nickComment,jdbcType=VARCHAR}, #{delYn,jdbcType=VARCHAR}, 
      #{insSeq,jdbcType=BIGINT}, #{insDt,jdbcType=TIMESTAMP}, #{uptSeq,jdbcType=BIGINT}, 
      #{uptDt,jdbcType=TIMESTAMP}, #{fileUuid,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="kr.co.infovine.dkmm.db.model.nicknm.TDefineNicknm">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 25 11:29:08 KST 2022.
    -->
    update t_define_nicknm
    set nick_nm = #{nickNm,jdbcType=VARCHAR},
      nick_img = #{nickImg,jdbcType=VARCHAR},
      work_seq = #{workSeq,jdbcType=BIGINT},
      nick_comment = #{nickComment,jdbcType=VARCHAR},
      del_yn = #{delYn,jdbcType=VARCHAR},
      upt_seq = #{uptSeq,jdbcType=BIGINT},
      upt_dt = now(),
      file_uuid = #{fileUuid,jdbcType=VARCHAR}
    where nick_seq = #{nickSeq,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 25 11:29:08 KST 2022.
    -->
    select nick_seq, nick_nm, nick_img, work_seq, nick_comment, del_yn, ins_seq, ins_dt, 
    upt_seq, upt_dt, file_uuid
    from t_define_nicknm
    where nick_seq = #{nickSeq,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Nov 25 11:29:08 KST 2022.
    -->
    select nick_seq, nick_nm, nick_img, work_seq, nick_comment, del_yn, ins_seq, ins_dt, 
    upt_seq, upt_dt, file_uuid
    from t_define_nicknm
  </select>
  
  <select id="selectAlldefineNicknm" parameterType="kr.co.infovine.dkmm.db.model.nicknm.TDefineNicknm" resultMap="BaseResultMap">
   SELECT
         ROW_NUMBER() OVER() AS rowNum
        ,a.nick_seq
        ,a.nick_nm
        ,a.nick_comment
        ,(CASE
			 WHEN a.file_uuid  is not NULL THEN 'Y'
			  ELSE 'N'
			END
		) AS file_uuid
        ,(SELECT work_nm FROM t_define_work WHERE nick_seq = a.nick_seq and DEL_YN = 'N' and use_yn = 'Y') as work_nm
     FROM t_define_nicknm a
     WHERE 1=1
     AND del_yn = 'N'
     <include refid="searchCondition_nick"></include>
     ORDER BY nick_seq DESC
  </select>
  
  
  <select id="selectNicknmDetail" parameterType="kr.co.infovine.dkmm.db.model.nicknm.TDefineNicknm" resultMap="BaseResultMap">
  SELECT
             a.nick_seq
            ,a.nick_nm
            ,a.nick_comment
            ,a.del_yn
            ,ins_dt
            ,upt_dt
            ,a.file_uuid
            ,(SELECT file_nm FROM t_file_sub WHERE file_uuid_sub = a.file_uuid) as fileNm
			,(SELECT file_save_nm FROM t_file_sub WHERE file_uuid_sub = a.file_uuid) as fileSaveNm
            ,(SELECT work_nm FROM t_define_work WHERE nick_seq = a.nick_seq and DEL_YN = 'N' and use_yn = 'Y') as workNm
        FROM t_define_nicknm a
        WHERE 1=1
        AND nick_seq = ${nickSeq}
  </select>
  
  <select id="selectNickNm"  resultType="String">
  	SELECT nick_nm FROM t_define_nicknm WHERE 1=1 AND DEL_YN = 'N' AND nick_seq = #{nickSeq,jdbcType=INTEGER}
  </select>
  
  <select id="selectNickComment"  resultType="String">
  	SELECT nick_comment FROM t_define_nicknm WHERE 1=1 AND DEL_YN = 'N' AND nick_seq = #{nickSeq,jdbcType=INTEGER}
  </select>
  
</mapper>